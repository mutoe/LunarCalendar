(function(){var s=function(o,c){if(o&&c&&typeof c=="object"){for(var p in c){o[p]=c[p]}}return o};var t=function(a,b,c,d){var e=[];d=d||0;if(c<1)return e;var k=d;for(var i=0;i<c;i++){e.push({year:a,month:b,day:k});k++}return e};var u={100:'输入的年份超过了可查询范围，仅支持1891至2100年',101:'参数输入错误，请查阅文档'};var v=null;var w={current:'',setCurrent:function(a){if(this.current!=a){this.current=a;this.clear()}},set:function(a,b){if(!v)v={};v[a]=b;return v[a]},get:function(a){if(!v)v={};return v[a]},clear:function(){v=null}};var x=function(a,b){a=a+1;a=a<10?'0'+a:a;b=b<10?'0'+b:b;return'd'+a+b};var z=1890;var A=2100;var B={heavenlyStems:['甲','乙','丙','丁','戊','己','庚','辛','壬','癸'],earthlyBranches:['子','丑','寅','卯','辰','巳','午','未','申','酉','戌','亥'],zodiac:['鼠','牛','虎','兔','龙','蛇','马','羊','猴','鸡','狗','猪'],solarTerm:['小寒','大寒','立春','雨水','惊蛰','春分','清明','谷雨','立夏','小满','芒种','夏至','小暑','大暑','立秋','处暑','白露','秋分','寒露','霜降','立冬','小雪','大雪','冬至'],monthCn:['正','二','三','四','五','六','七','八','九','十','十一','十二'],dateCn:['初一','初二','初三','初四','初五','初六','初七','初八','初九','初十','十一','十二','十三','十四','十五','十六','十七','十八','十九','二十','廿一','廿二','廿三','廿四','廿五','廿六','廿七','廿八','廿九','三十','卅一']};var C={};C.y2013={"d0101":2,"d0102":2,"d0103":2,"d0105":1,"d0106":1,"d0209":2,"d0210":2,"d0211":2,"d0212":2,"d0213":2,"d0214":2,"d0215":2,"d0216":1,"d0217":1,"d0404":2,"d0405":2,"d0406":2,"d0407":1,"d0427":1,"d0428":1,"d0429":2,"d0430":2,"d0501":2,"d0608":1,"d0609":1,"d0610":2,"d0611":2,"d0612":2,"d0919":2,"d0920":2,"d0921":2,"d0922":1,"d0929":1,"d1001":2,"d1002":2,"d1003":2,"d1004":2,"d1005":2,"d1006":2,"d1007":2,"d1012":1};C.y2014={"d0101":2,"d0126":1,"d0131":2,"d0201":2,"d0202":2,"d0203":2,"d0204":2,"d0205":2,"d0206":2,"d0208":1,"d0405":2,"d0407":2,"d0501":2,"d0502":2,"d0503":2,"d0504":1,"d0602":2,"d0908":2,"d0928":1,"d1001":2,"d1002":2,"d1003":2,"d1004":2,"d1005":2,"d1006":2,"d1007":2,"d1011":1};C.y2015={"d0101":2,"d0102":2,"d0103":2,"d0104":1,"d0215":1,"d0218":2,"d0219":2,"d0220":2,"d0221":2,"d0222":2,"d0223":2,"d0228":1,"d0405":2,"d0406":2,"d0501":2,"d0502":2,"d0503":2,"d0620":2,"d0622":2,"d0903":2,"d0904":2,"d0905":2,"d0906":1,"d0927":2,"d1001":2,"d1002":2,"d1003":2,"d1004":2,"d1005":2,"d1006":2,"d1007":2,"d1010":1};C.y2016={"d0101":2,"d0102":2,"d0103":2,"d0206":1,"d0207":2,"d0208":2,"d0209":2,"d0210":2,"d0211":2,"d0212":2,"d0213":2,"d0214":1,"d0402":2,"d0403":2,"d0404":2,"d0430":2,"d0501":2,"d0502":2,"d0609":2,"d0610":2,"d0611":2,"d0612":1,"d0915":2,"d0916":2,"d0917":2,"d0918":1,"d1001":2,"d1002":2,"d1003":2,"d1004":2,"d1005":2,"d1006":2,"d1007":2,"d1008":1,"d1009":1,"d1231":2};C.y2017={"d0101":2,"d0102":2,"d0127":1,"d0128":2,"d0129":2,"d0130":2,"d0132":2,"d0201":2,"d0202":2,"d0204":1,"d0401":1,"d0402":2,"d0403":2,"d0404":2,"d0429":2,"d0430":2,"d0501":2,"d0527":1,"d0528":2,"d0529":2,"d0530":2,"d0930":1,"d1001":2,"d1002":2,"d1003":2,"d1004":2,"d1005":2,"d1006":2,"d1007":2,"d1008":2};C.y2018={"d0101":2,"d0211":1,"d0215":2,"d0216":2,"d0217":2,"d0218":2,"d0219":2,"d0220":2,"d0221":2,"d0224":1,"d0405":2,"d0406":2,"d0407":2,"d0408":1,"d0428":1,"d0429":2,"d0430":2,"d0501":2,"d0616":2,"d0617":2,"d0618":2,"d0922":2,"d0923":2,"d0924":2,"d0929":1,"d0930":1,"d1001":2,"d1002":2,"d1003":2,"d1004":2,"d1005":2,"d1006":2,"d1007":2,"d1229":1,"d1230":2,"d1231":2};C.y2019={"d0101":2,"d0202":1,"d0203":1,"d0204":2,"d0205":2,"d0206":2,"d0207":2,"d0208":2,"d0209":2,"d0210":2,"d0405":2,"d0406":2,"d0407":2,"d0427":1,"d0428":1,"d0429":2,"d0430":2,"d0501":2,"d0607":2,"d0608":2,"d0609":2,"d0913":2,"d0914":2,"d0915":2,"d0929":1,"d1001":2,"d1002":2,"d1003":2,"d1004":2,"d1005":2,"d1006":2,"d1007":2,"d1012":1}var D={'d0101':'元旦节','d0214':'情人节','d0308':'妇女节','d0312':'植树节','d0315':'消费者权益日','d0401':'愚人节','d0501':'劳动节','d0504':'青年节','d0601':'儿童节','d0701':'建党节','d0801':'建军节','d0910':'教师节','d1001':'国庆节','d1224':'平安夜','d1225':'圣诞节',};var E={'d0100':'除夕','d0101':'春节','d0115':'元宵节','d0505':'端午节','d0707':'七夕','d0715':'中元节','d0815':'中秋节','d0909':'重阳节','d1208':'腊八节','d1223':'小年',}var F=[[2,1,21,22184],[0,2,9,21936],[6,1,30,9656],[0,2,17,9584],[0,2,6,21168],[5,1,26,43344],[0,2,13,59728],[0,2,2,27296],[3,1,22,44368],[0,2,10,43856],[8,1,30,19304],[0,2,19,19168],[0,2,8,42352],[5,1,29,21096],[0,2,16,53856],[0,2,4,55632],[4,1,25,27304],[0,2,13,22176],[0,2,2,39632],[2,1,22,19176],[0,2,10,19168],[6,1,30,42200],[0,2,18,42192],[0,2,6,53840],[5,1,26,54568],[0,2,14,46400],[0,2,3,54944],[2,1,23,38608],[0,2,11,38320],[7,2,1,18872],[0,2,20,18800],[0,2,8,42160],[5,1,28,45656],[0,2,16,27216],[0,2,5,27968],[4,1,24,44456],[0,2,13,11104],[0,2,2,38256],[2,1,23,18808],[0,2,10,18800],[6,1,30,25776],[0,2,17,54432],[0,2,6,59984],[5,1,26,27976],[0,2,14,23248],[0,2,4,11104],[3,1,24,37744],[0,2,11,37600],[7,1,31,51560],[0,2,19,51536],[0,2,8,54432],[6,1,27,55888],[0,2,15,46416],[0,2,5,22176],[4,1,25,43736],[0,2,13,9680],[0,2,2,37584],[2,1,22,51544],[0,2,10,43344],[7,1,29,46248],[0,2,17,27808],[0,2,6,46416],[5,1,27,21928],[0,2,14,19872],[0,2,3,42416],[3,1,24,21176],[0,2,12,21168],[8,1,31,43344],[0,2,18,59728],[0,2,8,27296],[6,1,28,44368],[0,2,15,43856],[0,2,5,19296],[4,1,25,42352],[0,2,13,42352],[0,2,2,21088],[3,1,21,59696],[0,2,9,55632],[7,1,30,23208],[0,2,17,22176],[0,2,6,38608],[5,1,27,19176],[0,2,15,19152],[0,2,3,42192],[4,1,23,53864],[0,2,11,53840],[8,1,31,54568],[0,2,18,46400],[0,2,7,46752],[6,1,28,38608],[0,2,16,38320],[0,2,5,18864],[4,1,25,42168],[0,2,13,42160],[10,2,2,45656],[0,2,20,27216],[0,2,9,27968],[6,1,29,44448],[0,2,17,43872],[0,2,6,38256],[5,1,27,18808],[0,2,15,18800],[0,2,4,25776],[3,1,23,27216],[0,2,10,59984],[8,1,31,27432],[0,2,19,23232],[0,2,7,43872],[5,1,28,37736],[0,2,16,37600],[0,2,5,51552],[4,1,24,54440],[0,2,12,54432],[0,2,1,55888],[2,1,22,23208],[0,2,9,22176],[7,1,29,43736],[0,2,18,9680],[0,2,7,37584],[5,1,26,51544],[0,2,14,43344],[0,2,3,46240],[4,1,23,46416],[0,2,10,44368],[9,1,31,21928],[0,2,19,19360],[0,2,8,42416],[6,1,28,21176],[0,2,16,21168],[0,2,5,43312],[4,1,25,29864],[0,2,12,27296],[0,2,1,44368],[2,1,22,19880],[0,2,10,19296],[6,1,29,42352],[0,2,17,42208],[0,2,6,53856],[5,1,26,59696],[0,2,13,54576],[0,2,3,23200],[3,1,23,27472],[0,2,11,38608],[11,1,31,19176],[0,2,19,19152],[0,2,8,42192],[6,1,28,53848],[0,2,15,53840],[0,2,4,54560],[5,1,24,55968],[0,2,12,46496],[0,2,1,22224],[2,1,22,19160],[0,2,10,18864],[7,1,30,42168],[0,2,17,42160],[0,2,6,43600],[5,1,26,46376],[0,2,14,27936],[0,2,2,44448],[3,1,23,21936],[0,2,11,37744],[8,2,1,18808],[0,2,19,18800],[0,2,8,25776],[6,1,28,27216],[0,2,15,59984],[0,2,4,27424],[4,1,24,43872],[0,2,12,43744],[0,2,2,37600],[3,1,21,51568],[0,2,9,51552],[7,1,29,54440],[0,2,17,54432],[0,2,5,55888],[5,1,26,23208],[0,2,14,22176],[0,2,3,42704],[4,1,23,21224],[0,2,11,21200],[8,1,31,43352],[0,2,19,43344],[0,2,7,46240],[6,1,27,46416],[0,2,15,44368],[0,2,5,21920],[4,1,24,42448],[0,2,12,42416],[0,2,2,21168],[3,1,22,43320],[0,2,9,26928],[7,1,29,29336],[0,2,17,27296],[0,2,6,44368],[5,1,26,19880],[0,2,14,19296],[0,2,3,42352],[4,1,24,21104],[0,2,10,53856],[8,1,30,59696],[0,2,18,54560],[0,2,7,55968],[6,1,27,27472],[0,2,15,22224],[0,2,5,19168],[4,1,25,42216],[0,2,12,42192],[0,2,1,53584],[2,1,21,55592],[0,2,9,54560]];var G=[0,21208,42467,63836,85337,107014,128867,150921,173149,195551,218072,240693,263343,285989,308563,331033,353350,375494,397447,419210,440795,462224,483532,504758];function getLunarLeapYear(a){var b=F[a-z];return b[0]};function getLunarYearDays(a){var b=F[a-z];var c=b[0];var d=b[3].toString(2);var e=d.split('');for(var i=0;i<16-e.length;i++){e.unshift(0)}var f=c?13:12;var g=0;var h=[];for(var i=0;i<f;i++){if(e[i]==0){g+=29;h.push(29)}else{g+=30;h.push(30)}}return{yearDays:g,monthDays:h}};function getLunarDateByBetween(a,b){var c=getLunarYearDays(a);var d=b>0?b:c.yearDays-Math.abs(b);var e=c.monthDays;var f=0;var g=0;for(var i=0;i<e.length;i++){f+=e[i];if(f>d){g=i;f=f-e[i];break}}return[a,g,d-f+1]};function getLunarByBetween(a,b,c){var d=F[a-z];var e=d[1];var f=d[2];var g=getDaysBetweenSolar(a,e-1,f,a,b,c);if(g==0){return[a,0,1]}else{var h=g>0?a:a-1;return getLunarDateByBetween(h,g)}};function getDaysBetweenSolar(a,b,c,d,e,f){var g=new Date(a,b,c).getTime();var h=new Date(d,e,f).getTime();return(h-g)/86400000};function getDaysBetweenZheng(a,b,c){var d=getLunarYearDays(a);var e=d.monthDays;var f=0;for(var i=0;i<e.length;i++){if(i<b){f+=e[i]}else{break}};return f+c-1};function getTerm(y,n){var a=new Date((31556925974.7*(y-1890)+G[n]*60000)+Date.UTC(1890,0,5,16,2,31));return(a.getUTCDate())};function getYearTerm(a){var b={};var c=0;for(var i=0;i<24;i++){var d=getTerm(a,i);if(i%2==0)c++b[x(c-1,d)]=B.solarTerm[i]}return b};function getYearZodiac(a){var b=a-1890+25;return B.zodiac[b%12]};function cyclical(a){return(B.heavenlyStems[a%10]+B.earthlyBranches[a%12])}function getLunarYearName(a,b){b=b||0;return cyclical(a-1890+25+b)};function getLunarMonthName(a,b,c){c=c||0;return cyclical((a-1890)*12+b+12+c)};function getLunarDayName(a,b,c){var d=Date.UTC(a,b,c)/86400000+29219+18;return cyclical(d)};function getSolarMonthDays(a,b){var c=[31,isLeapYear(a)?29:28,31,30,31,30,31,31,30,31,30,31];return c[b]};function isLeapYear(a){return((a%4==0&&a%100!=0)||(a%400==0))};function formateDate(a,b,c,d){var e=arguments.length;var f=new Date();a=e?parseInt(a,10):f.getFullYear();b=e?parseInt(b-1,10):f.getMonth();c=e?parseInt(c,10)||f.getDate():f.getDate();if(a<(d?d:z+1)||a>A)return{error:100,msg:u[100]};return{year:a,month:b,day:c}};function lunarToSolar(a,b,c){var d=formateDate(a,b,c);if(d.error)return d;var e=d.year;var f=d.month;var g=d.day;var h=getDaysBetweenZheng(e,f,g);var i=F[e-z];var j=i[1];var k=i[2];var l=new Date(e,j-1,k).getTime()+h*86400000;l=new Date(l);return{year:l.getFullYear(),month:l.getMonth()+1,day:l.getDate()}};function solarToLunar(a,b,c){var d=formateDate(a,b,c,z);if(d.error)return d;var e=d.year;var f=d.month;var g=d.day;w.setCurrent(e);var h=w.get('term2')?w.get('term2'):w.set('term2',getTerm(e,2));var i=w.get('termList')?w.get('termList'):w.set('termList',getYearTerm(e));var j=getTerm(e,f*2);var k=(f>1||f==1&&g>=h)?e+1:e;var l=g>=j?f+1:f;var m=getLunarByBetween(e,f,g);var n=getLunarLeapYear(m[0]);var o='';if(n>0&&n==m[1]){o='闰'+B.monthCn[m[1]-1]+'月'}else if(n>0&&m[1]>n){o=B.monthCn[m[1]-1]+'月'}else{o=B.monthCn[m[1]]+'月'}var p='';var q=getLunarYearDays(m[0]).monthDays;if(m[1]==q.length-1&&m[2]==q[q.length-1]){p=E['d0100']}else if(n>0&&m[1]>n){p=E[x(m[1]-1,m[2])]}else{p=E[x(m[1],m[2])]}var r={zodiac:getYearZodiac(k),GanZhiYear:getLunarYearName(k),GanZhiMonth:getLunarMonthName(e,l),GanZhiDay:getLunarDayName(e,f,g),worktime:C['y'+e]&&C['y'+e][x(f,g)]?C['y'+e][x(f,g)]:0,term:i[x(f,g)],lunarYear:m[0],lunarMonth:m[1]+1,lunarDay:m[2],lunarMonthName:o,lunarDayName:B.dateCn[m[2]-1],lunarLeapMonth:n,solarFestival:D[x(f,g)],lunarFestival:p,isBigMonth:q[m[1]]==30};return r};function calendar(a,b,c){var d=formateDate(a,b);if(d.error)return d;var e=d.year;var f=d.month;var g=solarCalendar(e,f+1,c);for(var i=0;i<g.monthData.length;i++){var h=g.monthData[i];var j=solarToLunar(h.year,h.month,h.day);s(g.monthData[i],j)}return g};function solarCalendar(a,b,c){var d=formateDate(a,b);if(d.error)return d;var e=d.year;var f=d.month;var g=new Date(e,f,1);var h,preMonthData,nextMonthData;var i={firstDay:g.getDay(),monthDays:getSolarMonthDays(e,f),monthData:[]};i.monthData=t(e,f+1,i.monthDays,1);if(c){if(i.firstDay>0){var j=f-1<0?e-1:e;var k=f-1<0?11:f-1;h=getSolarMonthDays(j,k);preMonthData=t(j,k+1,i.firstDay,h-i.firstDay+1);i.monthData=preMonthData.concat(i.monthData)}if(7*6-i.monthData.length!=0){var l=f+1>11?e+1:e;var m=f+1>11?0:f+1;var n=7*6-i.monthData.length;nextMonthData=t(l,m+1,n,1);i.monthData=i.monthData.concat(nextMonthData)}}return i};function setWorktime(a){s(C,a)};var H={solarToLunar:solarToLunar,lunarToSolar:lunarToSolar,calendar:calendar,solarCalendar:solarCalendar,setWorktime:setWorktime,getSolarMonthDays:getSolarMonthDays};if(typeof define==='function'){define(function(){return H})}else if(typeof exports==='object'){module.exports=H}else{window.LunarCalendar=H}})();
